The data generated by `dfMaker` is raw data, which means `dfMaker` only structures the data from `OpenPose` but statistics treatment is needed. Here some functions are presented as tool to make statistics treatment of `OpenPose` data.

# `fast.mode`

The data structured by `dfMaker` can be in one `CSV` file, if it was manually saved, or in several `CSV` files generated by `save.csv` attribute from `dfMaker`. The second case needs to load and assemble the data and the loading time is bigger, but sometimes is better to have a file for subset instead of just a full set.

### Function attributes

fast.mode(fast.mode = `FALSE`, path = "/home/user/filesCSV/")

fast.mode(fast.mode = `TRUE`, path = "/home/user/filesCSV/dataSet.csv")

# `maxPeople`

:notebook: [Example (`R`)](functionsExamples/maxPeopleExample.R)

This function reads `csv` files generated by `dfmaker` and select data with a maximum amount of people detected. It must be improve, but right now is useful to select data where only one person has been detected by `OpenPose` which implies the speaker is who makes the gesticulation. The function can read a full folder or only some videos inside the folder when a `csv` file with the names of wanted videos is provided.

### Function attributes

maxPeople(path = "/home/user/dfMakerOutputCSV/", max = 2,full.folder = `TRUE`)

max.people(path = "/home/user/dfMakerOutputCSV/", max = 2,full.folder = `FALSE`, fileNames = "/home/user/selectedFiles.csv")

-   `path`: The raw csv files path generated by `dfMaker`.

-   `max`: The maximum people desired which appear in videos.

-   `full.folder`: Boolean variable (`TRUE`/`FALSE`) to select all files in folder.

-   `fileNames`: In case `full.folder = FALSE` file names must be provided in a `csv` or `txt` file.

**warning!!!** the file names inside `txt` or `csv` file must have the extension `.csv`.

# `clipCleaner`


:notebook: [Example (`R`)](functionsExamples/clipCleanerExample.R)



Sometimes `OpenPose` detects objects as people which are not people. It is hard to find an universal method to remove all misdetected points. Here is propose a method to remove objects where point 1 (chest point) is not detected in any video's frame.

The method is simple, but for the moment it only works with 2 people detected due to it is the simplest case. If any video where we know there is a person and his/her chest appears on frames but the software detects another person which is not there this method is optimal, but for more complex objects a new method must be develop yet.

### Function attributes

clipCleaner(data= data, read.path== (TRUE/FALSE), path = "/home/user/dfMakerOutputCSV/",extract.goodCLips = T, save.goodClips.path ="/home/user/selectedCSV/")

| :warning: WARNING                                                                                                                                       |
|:-----------------------------------------------------------------------|
| `selectedCSV/` to create the folder, otherwise (`selectedCSV`) generate files in parent folder. Remmbember always to use `/` at the end of output path. |

-   `data`: In case data is already load in R there is no need for a path.

-   `read.path`:  Boolean variable (`TRUE`/`FALSE`) to read files from folder (`TRUE`) or read a R object already loaded (`FALSE`) .

-   `path`: The raw csv files path generated by `dfMaker`.

-   `extract.goodCLips`: Boolean variable (`TRUE`/`FALSE`) to save or not selected `csv` files in other folder.

-   `goodClips.path`: The path to save selected `csv` files.

### To take in account

-   `clipCleaner` removes automatically all face and hands key_points; only the pose_key_points remain. This can be change and the idea is to include them in a future version when face and hands points are considered.

-   If there is no chest key_point detected in any frame for the second person detected the video is considered as good video else the function works as `maxPeople` with a fix parameter to `max` attribute set to 1 person detected.

# xyCorrector

| :warning: WARNING                                                                                                                                 |
|:-----------------------------------------------------------------------|
| From this point functions are only working for pose_keypoints other systems must be develop for data from `face_keypoints` and `hands_keypoints`. |

:notebook: [Example (`R`)](functionsExamples/xyCorrectorExample.R)


OpenPose videos are based on a two dimensional Cartesian coordinate system and a point (0,0) must be defined, and this point can be one of the 25 points in pose_keypoints. `xyCorrector` allows to select one of the 25 points or their combination, x axe and y axe have independent treatment, and to set a detected point in the frame as original point (0,0) and to create a standardised reference system.


:bangbang: `xyCorrector` create two new variables `x2` and `y2` which are the corrections of raw data, but `x` and `y` values are still in the `data frame`. :bangbang:

 ![Example of a frame treated with xyCorrector](functionsExamples/xyCorrectorPlot.png)

### Function attributes

xyCorrector(df = example,df.full = T,set.NAs = T,fixed.point.x = 1,fixed.point.y = 1,reverse.y = T,set.x = T ,set.y = T)

-   `df`: An `R` objcet with `data Frame` structure `str(df)`.

-   `df.full`: Boolean variable (`TRUE`/`FALSE`) to remove `face_keypoint` and `hands_keypoints` in case it has not been done yet.

-   `set.Nas`: Boolean variable (`TRUE`/`FALSE`) to turn 0 values into `NA` values. This is need it because zero (0) now it is a real value (axes origin)

-   `reverse.y` : Boolean variable (`TRUE`/`FALSE`) set as `TRUE` by default. It indicates if the y axis must be inverted or not.

-   `set.x = T`and `set.y = T` : Boolean variables (`TRUE`/`FALSE`) set as `TRUE` by default. If they are set as `FALSE` the function does not transform the axe selected. Treatment of axes are independent.


# `cramerOpenPose`

:notebook: [Example (`R`)](functionsExamples/cramerOpenPoseExample.R)


The [Cramer's rule](https://en.wikipedia.org/wiki/Cramer%27s_rule) allows to define the units for our system. In the case of our data the distance between chest and left shoulder (in mirror perspective) has value 1 and the rest of distances takes new values according with this value.

The objetive achive by `CramerOpenPose` is to applay the Cramer's rule to all frames generating a new values for x e y (`nx`,`ny`) where independently of the distance to camera or person position, even if he/she changes position during video the distance between chest and left shoulder is 1.

 ![Example of a frame treated with xyCorrector](functionsExamples/cramerOpenPoseExample.png)


| :warning: WARNING                                                                                                                                 |
|:-----------------------------------------------------------------------|
| The person must be looking at camera or the distance between the chest and shoulder can be null, generating an indeterminate or inconsistent equation system.    |


### Function attributes

cramerOpenPose(data = example,v.i =5,orthonormal=T,save.video.csv=T,path.save.videos="home/user/cleanDataCSV/" )


* `data` : `R` object with all data from `xyCorrector`. The structure must be `data frame`.

* `v.i` : point from pose_keypoints to create the unit vector for x axe with chest point (0,0). In this case the left shoulder (5).

* `orthonormal`:  Boolean variable (`TRUE`/`FALSE`) to use the same vector (`v.i`) to create the identity matrix.

*  `v.y`: point from pose_keypoints to create the unit vector for y axe with chest point (0,0). Only use when a non-orthogonal system  is desired.

* `save.video.csv`: Boolean variable (`TRUE`/`FALSE`) to save or not normalized data in `csv` files; one file per video.

* `path.save.videos`: The path to save selected `csv` files.